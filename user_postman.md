è¿™é‡Œæ˜¯ä¸ºæ‚¨æ•´ç†å¥½çš„ Markdown æ ¼å¼çš„ Postman æµ‹è¯•æŒ‡å—ã€‚æ‚¨å¯ä»¥ç›´æ¥å¤åˆ¶ä¿å­˜ä¸º `README_TEST.md` æˆ–ç›´æ¥ç²˜è´´åˆ°æ‚¨çš„æ–‡æ¡£ä¸­ã€‚

---

# ğŸ§ª ä¸å¯ç¯¡æ”¹æ–‡æœ¬å­˜è¯å¹³å° - Postman æ¥å£æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£ç”¨äºæŒ‡å¯¼å¦‚ä½•ä½¿ç”¨ Postman å¯¹å¹³å°çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆæ³¨å†Œç™»å½•ã€å­˜è¯ã€ç‚¹å¯¹ç‚¹åˆ†äº«ã€é“¾æ¥åˆ†äº«åŠæ’¤é”€ï¼‰è¿›è¡Œå®Œæ•´æµç¨‹æµ‹è¯•ã€‚

## ğŸ› ï¸ 0. å‰ç½®å‡†å¤‡

* **æœåŠ¡å™¨åœ°å€**: `http://localhost:8080`
* **Content-Type**: æ‰€æœ‰ POST è¯·æ±‚çš„ Body ç±»å‹è¯·é€‰æ‹© **`raw`** -> **`JSON`**ã€‚
* **Cookie å¤„ç†**:
* Postman é»˜è®¤ä¼šè‡ªåŠ¨ä¿å­˜æœåŠ¡å™¨è¿”å›çš„ `JSESSIONID` Cookieã€‚
* **âš ï¸ é‡è¦æç¤º**ï¼šåœ¨åˆ‡æ¢ç”¨æˆ·æµ‹è¯•ï¼ˆå¦‚ä» User A åˆ‡æ¢åˆ° User Bï¼‰å‰ï¼Œ**åŠ¡å¿…è°ƒç”¨â€œç™»å‡ºæ¥å£â€**ï¼Œæˆ–è€…æ‰‹åŠ¨åœ¨ Postman çš„ Cookies ç®¡ç†å™¨ä¸­æ¸…é™¤ `localhost` çš„ Cookieï¼Œå¦åˆ™ä¼šå¯¼è‡´èº«ä»½æ··æ·†ã€‚



---

## ğŸŸ¢ ç¬¬ä¸€é˜¶æ®µï¼šç”¨æˆ· A åŸºç¡€æ“ä½œ (æ³¨å†Œ/ç™»å½•/å­˜è¯)

### 1. å‘é€éªŒè¯ç 

* **åŠŸèƒ½**: å‘é‚®ç®±å‘é€ 6 ä½éªŒè¯ç ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/code`
* **Params** (Query Params):
* `email`: `user_a@example.com`


* **ğŸ‘€ éªŒè¯**: æŸ¥çœ‹åç«¯æ§åˆ¶å°ï¼ˆConsoleï¼‰æ—¥å¿—ï¼Œæ‰¾åˆ°ç±»ä¼¼ `>>> é‚®ä»¶å‘é€è‡³ [...] éªŒè¯ç : 123456`ã€‚

### 2. æ³¨å†Œç”¨æˆ· (User A)

* **åŠŸèƒ½**: å®Œæˆè´¦å·æ³¨å†Œã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/register`
* **Body** (JSON):
```json
{
    "email": "user_a@example.com",
    "username": "user_a",
    "password": "password123",
    "code": "123456"  // å¡«å†™æ§åˆ¶å°çœ‹åˆ°çš„éªŒè¯ç 
}

```



### 3. ç™»å½• (User A)

* **åŠŸèƒ½**: ç™»å½•å¹¶è·å– Sessionã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/login`
* **Body** (JSON):
```json
{
    "account": "user_a",
    "password": "password123"
}

```


* **âœ… ç»“æœ**: è¯·æ±‚æˆåŠŸåï¼ŒPostman ä¼šè‡ªåŠ¨ä¿å­˜ `JSESSIONID`ã€‚

### 4. å­˜å‚¨æ–‡æœ¬

* **åŠŸèƒ½**: ä¸Šä¼ ä¸€æ®µæ–‡æœ¬è¿›è¡Œå­˜è¯ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/proof/upload`
* **Body** (JSON):
```json
{
    "subject": "Açš„é‡è¦åˆåŒ",
    "content": "è¿™æ˜¯ç”¨æˆ·Aæ‰€æœ‰çš„ç¬¬ä¸€ä»½é‡è¦åˆåŒå†…å®¹ï¼Œä¸å¯ç¯¡æ”¹ã€‚"
}

```


* **ğŸ“ è®°å½•**: è¯·è®°ä¸‹è¿”å›æ•°æ®ä¸­çš„ **`"id": 1`** (å‡è®¾ä¸º1)ï¼Œåç»­æ­¥éª¤éœ€è¦ä½¿ç”¨ã€‚

### 5. æŸ¥çœ‹æˆ‘çš„å­˜è¯åˆ—è¡¨

* **åŠŸèƒ½**: ç¡®è®¤åˆšæ‰ä¸Šä¼ æˆåŠŸã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/proof/list`

---

## ğŸŸ¡ ç¬¬äºŒé˜¶æ®µï¼šç”¨æˆ· A åˆ†äº«æ“ä½œ (æ–°åŠŸèƒ½)

> **å‰æ**ï¼šç¡®ä¿å½“å‰ä»å¤„äº User A çš„ç™»å½•çŠ¶æ€ã€‚

### 6. åˆ†äº«ç»™æŒ‡å®šç”¨æˆ· (å¸¦æ—¶æ•ˆ)

* **åŠŸèƒ½**: å°†å­˜è¯åˆ†äº«ç»™ User Bï¼Œå¹¶è®¾ç½®æœ‰æ•ˆæœŸã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/to-user`
* **Body** (JSON):
```json
{
    "proofId": 1,          // åˆšæ‰ä¸Šä¼ çš„å­˜è¯ID
    "targetUsername": "user_b", // ç›®æ ‡ç”¨æˆ·(éœ€ç¡®ä¿è¯¥ç”¨æˆ·å·²æ³¨å†Œï¼Œè‹¥æœªæ³¨å†Œè¯·å…ˆå»æ³¨å†ŒB)
    "validMinutes": 5      // 5åˆ†é’Ÿæœ‰æ•ˆï¼Œä¼  null æˆ– <=0 ä¸ºæ°¸ä¹…
}

```



### 7. ç”Ÿæˆåˆ†äº«é“¾æ¥ (å¸¦æ—¶æ•ˆ)

* **åŠŸèƒ½**: ç”Ÿæˆä¸€ä¸ªå…¬å¼€è®¿é—®çš„ Token é“¾æ¥ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/create-link`
* **Body** (JSON):
```json
{
    "proofId": 1,
    "validMinutes": 60     // 1å°æ—¶æœ‰æ•ˆ
}

```


* **ğŸ“ è®°å½•**: å“åº”ä¸­çš„ `data` å­—æ®µå³ä¸º **Token** (ä¾‹å¦‚ `abc12345...`)ï¼Œè¯·å¤åˆ¶å®ƒã€‚

### 8. æ’¤é”€/å–æ¶ˆåˆ†äº« (åæ‚”è¯)

* **åŠŸèƒ½**: æ’¤é”€åˆšæ‰ç”Ÿæˆçš„é“¾æ¥ï¼ˆæµ‹è¯•æ’¤é”€åé“¾æ¥æ˜¯å¦å¤±æ•ˆï¼‰ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/revoke/link`
* **Params** (Query Params):
* `token`: `abc12345...` (å¡«å…¥æ­¥éª¤7è·å–çš„Token)


* **é¢„æœŸ**: è¿”å›â€œé“¾æ¥å·²å¤±æ•ˆâ€ã€‚

### 9. ç™»å‡º (User A)

* **åŠŸèƒ½**: æ¸…é™¤ User A çš„ Sessionï¼Œå‡†å¤‡åˆ‡æ¢ç”¨æˆ·ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/logout`

---

## ğŸ”µ ç¬¬ä¸‰é˜¶æ®µï¼šç”¨æˆ· B æ“ä½œæµç¨‹

### 10. æ³¨å†Œä¸ç™»å½• (User B)

* **æ³¨å†Œ**: å‚è€ƒæ­¥éª¤ 1 & 2ï¼Œå°†é‚®ç®±æ”¹ä¸º `user_b@example.com`ï¼Œç”¨æˆ·åæ”¹ä¸º `user_b`ã€‚
* **ç™»å½•**: å‚è€ƒæ­¥éª¤ 3ï¼Œä½¿ç”¨ `user_b` ç™»å½•ã€‚

### 11. æŸ¥çœ‹â€œåˆ†äº«ç»™æˆ‘â€çš„åˆ—è¡¨

* **åŠŸèƒ½**: æŸ¥çœ‹ User A åˆ†äº«è¿‡æ¥çš„æ–‡ä»¶ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/list`
* **é¢„æœŸå“åº”**:
```json
{
    "code": 200,
    "data": [
        {
            "proof": { "id": 1, "subject": "Açš„é‡è¦åˆåŒ", ... },
            "sharedBy": "user_a",
            "sharedAt": "..."
        }
    ]
}

```



### 12. æŸ¥çœ‹åˆ†äº«è¯¦æƒ…

* **åŠŸèƒ½**: æŸ¥çœ‹å…·ä½“å†…å®¹ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/detail/1`  (ID ä¸ºå­˜è¯ ID)

---

## ğŸŸ£ ç¬¬å››é˜¶æ®µï¼šå…¬å…±/æ¸¸å®¢è®¿é—® (æµ‹è¯•é“¾æ¥åˆ†äº«)

> **è¯´æ˜**: æ­¤æ¥å£åœ¨ `SecurityConfig` ä¸­å·²é…ç½®ä¸ºå…è®¸åŒ¿åè®¿é—®ï¼ˆæ— éœ€ç™»å½•ï¼‰ã€‚

### 13. è®¿é—®åˆ†äº«é“¾æ¥

* **åŠŸèƒ½**: ä½¿ç”¨ Token æŸ¥çœ‹å­˜è¯ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/view-link`
* **Params** (Query Params):
* `token`: `abc12345...` (æ­¥éª¤ 7 ç”Ÿæˆçš„ Token)


* **é¢„æœŸç»“æœ**:
* **æƒ…å†µ A (æ­£å¸¸)**: è¿”å›å­˜è¯å†…å®¹ JSONã€‚
* **æƒ…å†µ B (å·²æ’¤é”€)**: å¦‚æœä½ æ‰§è¡Œäº†æ­¥éª¤ 8ï¼Œè¿™é‡Œåº”è¿”å› `{ "code": 404, "message": "é“¾æ¥å·²å¤±æ•ˆï¼ˆè¢«æ’¤é”€ï¼‰" }`ã€‚
* **æƒ…å†µ C (å·²è¿‡æœŸ)**: å¦‚æœ `validMinutes` æ—¶é—´å·²è¿‡ï¼Œåº”è¿”å›è¿‡æœŸæç¤ºã€‚



---

## ğŸ“‹ æ¥å£é€ŸæŸ¥è¡¨

| æ¨¡å— | åŠŸèƒ½ | Method | URL | Body / Params | æƒé™ |
| --- | --- | --- | --- | --- | --- |
| **è®¤è¯** | å‘é€éªŒè¯ç  | POST | `/api/auth/code` | Query: `email` | å…¬å¼€ |
|  | æ³¨å†Œ | POST | `/api/auth/register` | JSON: æ³¨å†Œä¿¡æ¯ | å…¬å¼€ |
|  | ç™»å½• | POST | `/api/auth/login` | JSON: è´¦å·å¯†ç  | å…¬å¼€ |
|  | ç™»å‡º | POST | `/api/auth/logout` | æ—  | éœ€ç™»å½• |
| **å­˜è¯** | ä¸Šä¼ å­˜è¯ | POST | `/api/proof/upload` | JSON: `subject`, `content` | éœ€ç™»å½• |
|  | æˆ‘çš„åˆ—è¡¨ | GET | `/api/proof/list` | æ—  | éœ€ç™»å½• |
|  | å­˜è¯è¯¦æƒ… | GET | `/api/proof/{id}` | æ—  | éœ€ç™»å½• |
| **åˆ†äº«** | åˆ†äº«ç»™ç”¨æˆ· | POST | `/api/share/to-user` | JSON: `proofId`, `targetUsername`, `validMinutes` | éœ€ç™»å½• |
|  | ç”Ÿæˆé“¾æ¥ | POST | `/api/share/create-link` | JSON: `proofId`, `validMinutes` | éœ€ç™»å½• |
|  | **è®¿é—®é“¾æ¥** | **GET** | **`/api/share/view-link`** | **Query: `token**` | **å…¬å¼€/åŒ¿å** |
|  | æ’¤é”€é“¾æ¥ | POST | `/api/share/revoke/link` | Query: `token` | éœ€ç™»å½•(æœ¬äºº) |
|  | æ’¤é”€ç”¨æˆ·åˆ†äº« | POST | `/api/share/revoke/user` | Query: `shareId` | éœ€ç™»å½•(æœ¬äºº) |
| **è¢«åˆ†äº«** | æŸ¥çœ‹åˆ—è¡¨ | GET | `/api/share/list` | æ—  | éœ€ç™»å½• |
|  | æŸ¥çœ‹è¯¦æƒ… | GET | `/api/share/{id}` | æ—  | éœ€ç™»å½• |
